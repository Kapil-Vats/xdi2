<?xml version="1.0" encoding="UTF-8" ?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:util="http://www.springframework.org/schema/util" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.0.xsd">

	<!-- XDI Servlet -->

		<bean id="EndpointServlet" class="xdi2.server.EndpointServlet" init-method="init" destroy-method="destroy">

			<property name="interceptors">
				<util:list>
					<bean class="xdi2.server.interceptor.impl.DebugEndpointServletInterceptor" />
				</util:list>
			</property>
		
		</bean>

	<!-- MESSAGING TARGET at /mem-graph -->
	<!-- MessagingTarget: GraphMessagingTarget backed by a MemoryGraph -->
	<!-- Interceptors: VariablesInterceptor -->

		<bean id="graphfactory1" class="xdi2.core.impl.memory.MemoryGraphFactory">
		</bean>
	
		<bean id="graph1" factory-bean="graphfactory1" factory-method="openGraph" />
	
		<bean name="/mem-graph" class="xdi2.messaging.target.impl.graph.GraphMessagingTarget">
			<property name="graph" ref="graph1" />
			<property name="interceptors">
				<util:list>
					<bean class="xdi2.messaging.target.interceptor.impl.VariablesInterceptor" />
				</util:list>
			</property>
		</bean>

	<!-- MESSAGING TARGET at /bdb-graph -->
	<!-- MessagingTarget: GraphMessagingTarget backed by a BDBGraph -->
	<!-- Interceptors: VariablesInterceptor -->

		<bean id="graphfactory2" class="xdi2.core.impl.keyvalue.bdb.BDBGraphFactory">
		</bean>
	
		<bean id="graph2" factory-bean="graphfactory2" factory-method="openGraph" />
	
		<bean name="/bdb-graph" class="xdi2.messaging.target.impl.graph.GraphMessagingTarget">
			<property name="graph" ref="graph2" />
			<property name="interceptors">
				<util:list>
					<bean class="xdi2.messaging.target.interceptor.impl.VariablesInterceptor" />
				</util:list>
			</property>
		</bean>

	<!-- MESSAGING TARGET at /file-graph -->
	<!-- MessagingTarget: FileMessagingTarget backed by an XDI/JSON file -->
	<!-- Interceptors: VariablesInterceptor -->

		<bean name="/file-graph" class="xdi2.messaging.target.impl.file.FileMessagingTarget">
			<property name="filename" value="./xdi2-file/graph.xdi" />
			<property name="format" value="XDI/JSON" />
			<property name="interceptors">
				<util:list>
					<bean class="xdi2.messaging.target.interceptor.impl.VariablesInterceptor" />
				</util:list>
			</property>
		</bean>

	<!-- MESSAGING TARGET at /=markus -->
	<!-- MessagingTarget: GraphMessagingTarget backed by a MemoryGraph -->
	<!-- Interceptors: BootstrapInterceptor, VariablesInterceptor, CheckOwnerInterceptor, LinkContractsInterceptor -->

		<bean id="graphfactory4" class="xdi2.core.impl.memory.MemoryGraphFactory">
		</bean>
	
		<bean id="graph4" factory-bean="graphfactory4" factory-method="openGraph" />
	
		<bean name="/=markus" class="xdi2.messaging.target.impl.graph.GraphMessagingTarget">
			<property name="graph" ref="graph4" />
			<property name="interceptors">
				<util:list>
					<bean class="xdi2.messaging.target.interceptor.impl.BootstrapInterceptor">
						<property name="bootstrapOwner" value="=!91F2.8153.F600.AE24" />
						<property name="bootstrapOwnerSynonyms">
							<util:list>
								<value>=markus</value>
							</util:list>
						</property>
						<property name="bootstrapSharedSecret" value="s3cret" />
						<property name="bootstrapLinkContract" value="true" />
					</bean>
					<bean class="xdi2.messaging.target.interceptor.impl.VariablesInterceptor" />
					<bean class="xdi2.messaging.target.interceptor.impl.CheckOwnerInterceptor" />
					<bean
						class="xdi2.messaging.target.interceptor.impl.LinkContractsInterceptor">
						<property name="linkContractsGraph" ref="graph4" />
					</bean>
				</util:list>
			</property>
		</bean>

</beans>
